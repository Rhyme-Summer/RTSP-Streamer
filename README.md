## RTSP Streamer 使用说明

**版本**：1.0.0  
**产品名称**：RTSP Streamer  
**产品别称**：RTSP视频推流工具
---

### 1. 功能简介

`RTSP Streamer` 是一款基于 FFmpeg 和 MediaMTX 的本地模拟摄像头/视频推流工具，可以将本地视频文件推送为 RTSP 流，供局域网内的设备（如 VLC、NVR、客户端程序等）进行拉流测试。

主要特性：
- 使用图形界面（Tkinter），操作简单
- 支持选择本地视频文件并循环推流
- 自动启动/停止 MediaMTX 服务器
- 自动生成本机可用 RTSP 地址（含局域网 IP）
- 支持不同分辨率输出

---

### 2. 运行环境要求

- 操作系统：Windows 10 或更高版本（64 位）

---

### 3. 图形界面使用说明

启动后，将看到“RTSP推流工具”窗口，主要区域说明如下：

- **视频文件**：
  - 可以点击“浏览”按钮选择本地视频文件
  - 也可以直接将视频文件拖拽到主窗口

- **RTSP 后缀**：
  - 默认值：`/stream_1`
  - 最终 RTSP 地址示例：`rtsp://<IP>:8554/stream_1`

- **分辨率**：
  - 可选择 `1920x1080 / 1280x720 / 854x480 / 640x360 / 原始分辨率`

- **循环推流**：
  - 勾选：视频播放结束后自动从头继续推流（无限循环）
  - 不勾选：视频播完后推流自动停止

- **MediaMTX 服务器控制**：
  - “启动服务器 / 停止服务器”：手动控制 MediaMTX
  - “结束占用进程”：结束占用 8554 端口的外部进程
  - “强制重启服务器”：先杀掉占用端口进程，再重启 MediaMTX
  - “检查服务器状态”：查看服务器和端口状态
  - “发送Ctrl+C”：尝试以 Ctrl+C 的方式优雅停止 MediaMTX

- **推流控制**：
  - “开始推流 / 停止推流”：开启/停止 FFmpeg 推流
  - “强制停止推流”：在常规停止失败时，强制结束 FFmpeg 进程
  - “显示推流URL”：弹出所有可用 RTSP / RTMP 地址说明
  - “测试推流连接”：检测 MediaMTX 是否正常、端口状态等

- **日志窗口**：
  - 显示所有操作日志（服务器状态、推流状态、错误信息等）
  - “清空日志”：清除当前日志内容

- **退出程序**：
  - “退出程序”按钮 或 关闭窗口
  - 如有正在运行的推流或服务器，会弹出确认提示，并在退出前自动停止

---

### 4. RTSP 地址说明

推流启动成功后，日志中会列出所有可用的 RTSP 地址，例如：

- 本机：
  - `rtsp://localhost:8554/stream_1`
  - `rtsp://127.0.0.1:8554/stream_1`
- 局域网 IP（示例）：
  - `rtsp://192.168.1.100:8554/stream_1`

使用方式：
- 在 VLC 等播放器中：
  - 打开“媒体” → “打开网络串流”
  - 输入上述任一 RTSP 地址即可观看

---

### 5. 常见问题

1. **无法找到 FFmpeg / MediaMTX**
   - 确认以下路径存在：
     - `ffmpeg\bin\ffmpeg.exe`
     - `ffmpeg\mediamtx\mediamtx.exe`
   - 确认运行目录为项目根目录

2. **端口 8554 已被占用**
   - 点击“结束占用进程”按钮
   - 或使用“强制重启服务器”

3. **局域网设备无法访问 RTSP**
   - 确认防火墙未拦截 8554 / 1935 端口
   - 确认使用的是正确的局域网 IP 地址

---

### 6. 联系与声明

This software uses FFmpeg licensed under the LGPLv2.1/GPLv3. The source code for FFmpeg can be found at ffmpeg.org.

